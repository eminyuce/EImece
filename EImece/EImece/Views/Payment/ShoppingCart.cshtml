@using EImece.Domain.Models.FrontModels;
@using EImece.Domain.Entities;
@using EImece.Domain.Helpers.HtmlHelpers;
@using EImece.Domain.Helpers.Extensions;
@using EImece.Domain.Helpers;
@using EImece.Domain;
@using Resources;
@model  ShoppingCartSession

@{
    ViewBag.Title = "ShoppingCart";
    var products = Model.ShoppingCartItems;
}

<section class="titlebar">
    <div class="container">
        <div class="sixteen columns">
            <h2>Shopping Cart</h2>

            <nav id="breadcrumbs">
                <ul>
                    <li><a href="#">Home</a></li>
                    <li>Shopping Cart</li>
                </ul>
            </nav>
        </div>
    </div>
</section>
 

<div class="container pb-5 mt-n2 mt-md-n3">
    <div class="row">
        <div class="col-xl-9 col-md-8">
            <h2 class="h6 d-flex flex-wrap justify-content-between align-items-center px-4 py-3 bg-secondary"><span>Products</span><a class="font-size-sm" href="shop-style1-ls.html"><i data-feather="chevron-left" style="width: 1rem; height: 1rem;"></i>Continue shopping</a></h2>

            @if (products.IsNotEmpty())
            {
                for (int i = 0; i < products.Count; i++)
                {
                    @CreateShoppingCartItem(products[i], i)
                }
            }
        </div>
        <!-- Sidebar-->
        <div class="col-xl-3 col-md-4 pt-3 pt-md-0">
            <h2 class="h6 px-4 py-3 bg-secondary text-center">Subtotal</h2>
            <div class="h3 font-weight-semibold text-center py-3"><span id="TotalPrice">@Model.TotalPrice.CurrencySign()</span></div>
            <hr>
            <h3 class="h6 pt-4 font-weight-semibold"><span class="badge badge-success mr-2">Note</span>Additional comments</h3>
            <textarea class="form-control mb-3" id="order-comments" rows="5"></textarea><a class="btn btn-primary btn-block" href="checkout-details.html"><i class="mr-2" data-feather="credit-card"></i>Proceed to Checkout</a>
        </div>
    </div>
</div>

@helper CreateShoppingCartItem(ShoppingCartItem item, int i)
{
    var product = item.product;
    double totalPricePerItem = product.Price * item.quantity;
    <!-- Item-->
    <div data-shopping-item-row="@item.ShoppingCartItemId" class="d-sm-flex justify-content-between my-4 pb-4 border-bottom">
        <input type="hidden" name=@String.Format("productId[{0}]", i) value="@item.product.Id">
        <input type="hidden" data-shopping-item-price="@item.ShoppingCartItemId" value="@product.Price" />
        <div class="media d-block d-sm-flex text-center text-sm-left">
            @if (!String.IsNullOrEmpty(product.CroppedImageUrl))
            {
                <a class="cart-item-thumb mx-auto mr-sm-4" href="@product.DetailPageUrl">
                    <img class="rsImg" src="@product.CroppedImageUrl" alt="" />
                </a>
            }

            <div class="media-body pt-3">
                <h3 class="product-card-title font-weight-semibold border-0 pb-0">
                    <a href="@product.DetailPageUrl">@product.Name</a>
                </h3>
                <div class="font-size-lg text-primary pt-2">@product.Price.CurrencySign()</div>
            </div>
        </div>
        <div class="pt-2 pt-sm-0 pl-sm-3 mx-auto mx-sm-0 text-center text-sm-left" style="max-width: 10rem;">
            <span data-shopping-item-total-price="@item.ShoppingCartItemId"> @totalPricePerItem.CurrencySign()</span>
            <div class="form-group mb-2">
                <label for="quantity2">Quantity</label>
                <input class="form-control form-control-sm" name=@String.Format("quantity[{0}]", i)
                       data-shopping-quantity-id="@item.ShoppingCartItemId"
                       type="number" id="quantity2" value="@item.quantity">
            </div>
            <button data-shopping-button-price="@item.ShoppingCartItemId" class="btn btn-outline-secondary btn-sm btn-block mb-2" type="button"><i class="mr-1" data-feather="refresh-cw"></i>@AdminResource.Update</button>
            <button data-shopping-item-remove="@item.ShoppingCartItemId" class="btn btn-outline-danger btn-sm btn-block mb-2" type="button"><i class="mr-1" data-feather="trash-2"></i>@AdminResource.Remove</button>
        </div>
    </div>

}
@section Scripts{

    <script>

        $(document).ready(function () {

        });
    </script>
}