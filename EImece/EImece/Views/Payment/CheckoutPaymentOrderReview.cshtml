@using EImece.Domain.Models.FrontModels;
@using EImece.Domain.Entities;
@using EImece.Domain.Helpers.HtmlHelpers;
@using EImece.Domain.Helpers.Extensions;
@using EImece.Domain.Helpers;
@using EImece.Domain;
@using Resources;
@model  ShoppingCartSession

@{
    ViewBag.Title = "CheckoutPaymentOrderReview";
    var products = Model.ShoppingCartItems;
}
<!-- Page Title-->
<div class="page-title-wrapper" aria-label="Page title">
    <div class="container">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="mt-n1 mr-1"><i data-feather="home"></i></li>
                <li class="breadcrumb-item">
                    <a href="index.html">Home</a>
                </li>
                <li class="breadcrumb-item">
                    <a href="#">Shop</a>
                </li>
            </ol>
        </nav>
        <h1 class="page-title">Checkout</h1><span class="d-block mt-2 text-muted"></span>
    </div>
</div>
<!-- Page Content-->
<div class="container pb-5 mb-sm-4 mt-n2 mt-md-n3">
    <!-- Steps (wizard)-->
    <div class="steps">
        <div class="steps-body">
            <a class="step step-completed" href="@Url.Action("ShoppingCart")">
                <span class="step-indicator"><i data-feather="check"></i></span>
                <span class="step-icon"><i data-feather="shopping-cart"></i></span>1.@Resource.MyBasket
            </a>
            <a class="step step-completed" href="@Url.Action("checkoutbillingdetails")">
                <span class="step-indicator">
                    <i data-feather="check"></i>
                </span><span class="step-icon">
                    <i data-feather="user"></i>
                </span>2.@AdminResource.OrderDetails
            </a>
            <a class="step step-active" href="@Url.Action("checkoutPaymentOrderReview")">
                <span class="step-indicator"><i data-feather="check"></i></span><span class="step-icon">
                    <i data-feather="credit-card">
                    </i>
                </span>3.@Resource.OrderFinalReview
            </a><a class="step step-active" href="@Url.Action("PlaceOrder")">
    <span class="step-icon">
        <i data-feather="check-circle"></i>
    </span>4.@AdminResource.Payment
</a>
        </div>
    </div>
    <div class="row pt-4 mt-2">
        <!-- Content-->
        <div class="col-xl-9 col-md-8">
            <h2 class="h6 px-4 py-3 bg-secondary mb-4">Review your order</h2>
            @if (products.IsNotEmpty())
            {
                for (int i = 0; i < products.Count; i++)
                {
                    @CreateShoppingCartItem(products[i], i)
                }
            }

            <!-- Client details-->
            <div class="bg-secondary px-4 pt-4 pb-2">
                <div class="row">
                    <div class="col-sm-6">
                        <h4 class="h6">Shipping to:</h4>
                        <ul class="list-unstyled">
                            <li><span class="text-muted">Client:&nbsp;</span>Daniel Adams</li>
                            <li><span class="text-muted">Address:&nbsp;</span>44 Shirley Ave. West Chicago, IL 60185, USA</li>
                            <li><span class="text-muted">Phone:&nbsp;</span>+1 (808) 764 554 330</li>
                        </ul>
                    </div>
                    <div class="col-sm-6">
                        <h4 class="h6">Payment method:</h4>
                        <ul class="list-unstyled">
                            <li><span class="text-muted">Credit Card:&nbsp;</span>**** **** **** 5300</li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- Navigation-->
            <div class="d-flex pt-4">
                <div class="w-50 pr-3"><a class="btn btn-outline-secondary btn-block" href="@Url.Action("checkoutbillingdetails")"><i class="mr-1" data-feather="chevron-left"></i>@Resource.Back</a></div>
                <div class="w-50 pl-2"><a class="btn btn-primary btn-block" href="@Url.Action("PlaceOrder")"><span class="d-none d-sm-inline">@AdminResource.Payment</span><span class="d-inline d-sm-none">Complete</span><i class="ml-1" data-feather="chevron-right"></i></a></div>
            </div>
        </div>
        <!-- Sidebar-->
        <div class="col-xl-3 col-md-4 pt-4 mt-3 pt-md-0 mt-md-0">
            <h2 class="h6 px-4 py-3 bg-secondary text-center">Order summary</h2>
            <div class="font-size-sm border-bottom pt-2 pb-3">
                <div class="d-flex justify-content-between mb-2"><span>Subtotal:</span><span>$325.00</span></div>
                <div class="d-flex justify-content-between mb-2"><span>Shipping:</span><span>$26.50</span></div>
                <div class="d-flex justify-content-between mb-2"><span>Taxes:</span><span>$7.25</span></div>
                <div class="d-flex justify-content-between"><span>Discount:</span><span>&mdash;</span></div>
            </div>
            <div class="h3 font-weight-semibold text-center py-3">$358.75</div>
            <form class="needs-validation" novalidate>
                <div class="form-group">
                    <input class="form-control" type="text" id="cart-promocode" placeholder="Promo code" required>
                    <div class="invalid-feedback">Please provide a valid promo code!</div>
                </div>
                <button class="btn btn-outline-primary btn-block" type="submit">Apply promo code</button>
            </form>
            <!-- Promo banner--><a class="d-block text-decoration-0 mt-4 mx-auto pt-2" href="#" style="max-width: 277px;">
                <div class="bg-secondary">
                    <div class="px-3 pt-4 text-center">
                        <h4 class="font-size-sm font-weight-normal pt-1 mb-2">2019 Spring / Summer</h4>
                        <h4 class="h5 pb-2">Hoodie Collection</h4>
                        <div class="btn btn-primary btn-sm">Shop now</div>
                    </div><img src="img/shop/banner01.jpg" alt="Promo banner">
                </div>
            </a>
        </div>
    </div>
</div>

@helper CreateShoppingCartItem(ShoppingCartItem item, int i)
{
    var product = item.product;
    double totalPricePerItem = product.Price * item.quantity;

    <!-- Item-->
    <div class="d-sm-flex justify-content-between my-4">
        <input type="hidden" name=@String.Format("productId[{0}]", i) value="@item.product.Id">
        <input type="hidden" data-shopping-item-price="@item.ShoppingCartItemId" value="@product.Price" />
        <div class="media d-block d-sm-flex text-center text-sm-left">
            @if (!String.IsNullOrEmpty(product.CroppedImageUrl))
            {
                <a class="cart-item-thumb mx-auto mr-sm-4" href="@product.DetailPageUrl">
                    <img src="@product.CroppedImageUrl" alt="Product">
                </a>
            }
            <div class="media-body pt-3">
                <h3 class="product-card-title font-weight-semibold border-0 pb-0">
                    <a href="@product.DetailPageUrl">Adidas Performance Hat</a>
                </h3>
                <div class="font-size-sm"><span class="text-muted mr-2">Price:</span>@product.Price.CurrencySign()</div>
                <div class="font-size-sm"><span class="text-muted mr-2">CategoryName:</span>@product.CategoryName</div>
            </div>
        </div>
        <div class="pt-2 pl-sm-3 mx-auto mx-sm-0 text-center text-sm-left" style="max-width: 10rem;">
            <div class="font-size-sm mb-3"><span class="text-muted mr-2">Quantity:</span><span class="font-weight-semibold">@item.quantity</span></div>
            <button class="btn btn-outline-secondary btn-sm btn-block mb-2" type="button"><i class="mr-1" data-feather="edit-2"></i>@AdminResource.Update</button>
        </div>
    </div>

}