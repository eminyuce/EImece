(function(n){"use strict";typeof define=="function"&&define.amd?define(["./blueimp-helper","./blueimp-gallery"],n):n(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)})(function(n,t){"use strict";n.extend(t.prototype.options,{videoContentClass:"video-content",videoLoadingClass:"video-loading",videoPlayingClass:"video-playing",videoPosterProperty:"poster",videoSourcesProperty:"sources"});var i=t.prototype.handleSlide;return n.extend(t.prototype,{handleSlide:function(n){i.call(this,n);this.playingVideo&&this.playingVideo.pause()},videoFactory:function(t,i,r){var u=this,e=this.options,o=this.elementPrototype.cloneNode(!1),a=n(o),d=[{type:"error",target:o}],f=r||document.createElement("video"),s=this.getItemProperty(t,e.urlProperty),c=this.getItemProperty(t,e.typeProperty),y=this.getItemProperty(t,e.titleProperty),p=this.getItemProperty(t,e.videoPosterProperty),l,w=this.getItemProperty(t,e.videoSourcesProperty),b,h,v,k;if(a.addClass(e.videoContentClass),y&&(o.title=y),f.canPlayType)if(s&&c&&f.canPlayType(c))f.src=s;else while(w&&w.length)if(b=w.shift(),s=this.getItemProperty(b,e.urlProperty),c=this.getItemProperty(b,e.typeProperty),s&&c&&f.canPlayType(c)){f.src=s;break}if(p&&(f.poster=p,l=this.imagePrototype.cloneNode(!1),n(l).addClass(e.toggleClass),l.src=p,l.draggable=!1,o.appendChild(l)),h=document.createElement("a"),h.setAttribute("target","_blank"),r||h.setAttribute("download",y),h.href=s,f.src){f.controls=!0;(r||n(f)).on("error",function(){u.setTimeout(i,d)}).on("pause",function(){v=!1;a.removeClass(u.options.videoLoadingClass).removeClass(u.options.videoPlayingClass);k&&u.container.addClass(u.options.controlsClass);delete u.playingVideo;u.interval&&u.play()}).on("playing",function(){v=!1;a.removeClass(u.options.videoLoadingClass).addClass(u.options.videoPlayingClass);u.container.hasClass(u.options.controlsClass)?(k=!0,u.container.removeClass(u.options.controlsClass)):k=!1}).on("play",function(){window.clearTimeout(u.timeout);v=!0;a.addClass(u.options.videoLoadingClass);u.playingVideo=f});n(h).on("click",function(n){u.preventDefault(n);v?f.pause():f.play()});o.appendChild(r&&r.element||f)}return o.appendChild(h),this.setTimeout(i,[{type:"load",target:o}]),o}}),t});